name: ğŸ“Š AtualizaÃ§Ã£o DiÃ¡ria de Progresso

"on":
  schedule:
    - cron: '0 9 * * *'  # DiÃ¡rio Ã s 09:00 UTC (06:00 BRT)
  workflow_dispatch:

jobs:
  daily-update:
    runs-on: ubuntu-latest
    
    permissions:
      contents: write
      
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Setup GitHub CLI
        run: |
          sudo apt-get update
          sudo apt-get install -y gh
          
      - name: Install dependencies
        run: |
          sudo apt-get install -y jq bc
          
      - name: Generate daily report and update dashboard
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "ğŸš€ Iniciando automaÃ§Ã£o diÃ¡ria..."
          
          # Gerar relatÃ³rio diÃ¡rio
          echo "ğŸ“ Gerando relatÃ³rio diÃ¡rio..."
          chmod +x scripts/weekly-report.sh
          ./scripts/weekly-report.sh
          
          # Atualizar dashboard com mÃ©tricas reais
          echo "ğŸ“Š Atualizando dashboard com mÃ©tricas das issues..."
          chmod +x scripts/dashboard-updater.sh
          ./scripts/dashboard-updater.sh
          
          echo "âœ… AutomaÃ§Ã£o concluÃ­da!"
          
      - name: Commit and push changes
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "ğŸ¤– GitHub Action Bot"
          git add .
          
          if git diff --staged --quiet; then
            echo "â„¹ï¸ Nenhuma mudanÃ§a para commit"
          else
            echo "ğŸ’¾ Commitando mudanÃ§as..."
            git commit -m "ğŸ¤– AtualizaÃ§Ã£o automÃ¡tica diÃ¡ria - Dashboard e mÃ©tricas atualizados"
            git push
            echo "âœ… MudanÃ§as commitadas e enviadas!"
          fi
